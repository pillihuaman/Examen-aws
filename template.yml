version: 0.2

phases:
  install:
    runtime-versions:
      java: corretto17  # Especificamos la versión de Java
    commands:
      - echo "Instalando SAM CLI..."
      - pip install aws-sam-cli

  build:
    commands:
      - echo "Compilando y empaquetando el proyecto con SAM..."
      # sam build compila el código y prepara los artefactos
      - sam build
      
      # sam package empaqueta los artefactos y los sube a un bucket S3
      # Reemplaza 'mi-bucket-de-artefactos-pipeline' con el nombre de tu bucket (Paso 2)
      - sam package --output-template-file packaged.yaml --s3-bucket mi-bucket-de-artefactos-pipeline

artifacts:
  files:
    # El artefacto de salida es la plantilla de CloudFormation lista para desplegar
    - packaged.yaml